---
import BaseLayout from "@/layouts/BaseLayout.astro";
import LinkCard from "@/components/LinkCard.astro";
import LinkList from "@/components/LinkList.astro";
import { getCollection } from "astro:content";

// export async function getStaticPaths() {
//   const categories = await getCollection("Categories");

//   return categories.map((category) => ({
//     params: { category: category.slug },
//     props: { category },
//   }));
// }

const categories = await getCollection("Categories");


const page = categories.find((category) => category.slug === slug);
if (!page) return Astro.redirect("/404");

const { category } = Astro.props;

const linksInCategory = await getCollection("Links", ({ data }) => {
  return data.category === category.slug;
});
---

<BaseLayout>
  <LinkList>
    {linksInCategory.map((link) => <LinkCard linkItem={link} />)}
  </LinkList>
</BaseLayout>
